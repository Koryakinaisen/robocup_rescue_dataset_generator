file_paths = [
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\algiers\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\algiers\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\algiers\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\algiers\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\christchurch\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\christchurch\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\christchurch\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\christchurch\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\graz\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\graz\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\graz\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\graz\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\novosibirsk\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\novosibirsk\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\novosibirsk\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\novosibirsk\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\otsu\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\otsu\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\otsu\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\otsu\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_berlin1\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_berlin1\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_berlin1\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_berlin1\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_bordeaux2\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_bordeaux2\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_bordeaux2\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_bordeaux2\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_eindhoven2\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_eindhoven2\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_eindhoven2\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_eindhoven2\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_kobe1\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_kobe1\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_kobe1\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_kobe1\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_kobe2\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_kobe2\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_kobe2\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_kobe2\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_mexico1\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_mexico1\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_mexico1\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_mexico1\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_mexico2\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_mexico2\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_mexico2\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_mexico2\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_ny1\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_ny1\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_ny1\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_paris1\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_paris1\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_paris1\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_paris1\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_sakae1\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_sakae1\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_sakae1\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_sakae1\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_vc1\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_vc1\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_vc1\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_vc1\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_vc2\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_vc2\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_vc2\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\RC23_vc2\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\vc\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\vc\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\vc\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\vc\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\vernon\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\vernon\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\vernon\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\vernon\TK24\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\vila_nova_de_gaia\AIT-Rescue\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\vila_nova_de_gaia\AIT-Rescue_B\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\vila_nova_de_gaia\Ri-one\dataset.csv",
    r"D:\RoboCup LOGS\JAPAN OPEN 2024\vila_nova_de_gaia\TK24\dataset.csv"
]

import csv
import random
import os

header = None
expected_columns = None
all_rows = []
processed_files = 0

for path in file_paths:
    try:
        with open(path, "r", newline="", encoding='utf-8') as file:
            reader = csv.reader(file)
            current_header = next(reader)  # Читаем заголовок

            # Определяем эталонное количество столбцов
            if not header:
                header = current_header
                expected_columns = len(header)
            else:
                # Проверяем совпадение количества столбцов
                if len(current_header) != expected_columns:
                    print(f"Пропуск {os.path.basename(path)}: {len(current_header)} столбцов вместо {expected_columns}")
                    continue

            # Обрабатываем данные
            valid_rows = 0
            for row in reader:
                if len(row) == expected_columns:
                    all_rows.append(row)
                    valid_rows += 1
                else:
                    print(f"Пропуск строки в {os.path.basename(path)}: несоответствие столбцов")

            processed_files += 1
            print(f"Обработан: {path} ({valid_rows} валидных строк)")

    except Exception as e:
        print(f"Ошибка в {path}: {str(e)}")

# Перемешиваем и сохраняем результат
random.shuffle(all_rows)

with open("dataset.csv", "w", newline="", encoding='utf-8') as file:
    writer = csv.writer(file)
    writer.writerow(header)
    writer.writerows(all_rows)

print(f"\nИтоги:")
print(f"Успешно обработано файлов: {processed_files}/{len(file_paths)}")
print(f"Всего записей в результате: {len(all_rows)}")